import{_ as a}from"./uni-icons.CFkbRkFL.js";import{N as s,f as e,B as l,o as t,c,w as r,a as o,b as u,F as i,r as n,e as d,t as h,i as f,z as y,h as _,H as k,J as m,O as p,I as v,k as w,p as b}from"./index-Ds1uBd_9.js";import{r as g}from"./uni-app.es.C8rTvpW-.js";import{j as C,_ as I,k as L,m as D}from"./index.CiApdTwd.js";const S=s("deatil",(()=>{const a=e(""),s=e([]),t=e(JSON.parse(localStorage.getItem("searchHistory"))||[]);return{searchResultDetail:s,getResuletDetailFn:()=>{if(a.value){(async()=>{const e=await C(a.value);l((()=>{s.value=e.result.songs}))})()}},keyword:a,historyList:t}})),F=I({__name:"searchList",props:["result"],emits:["callParentFn"],setup(a,{emit:s}){const e=s,l=a;S();return(a,s)=>{const y=f;return t(),c(y,{class:"searchDetail"},{default:r((()=>[o(y,{class:"search-list"},{default:r((()=>[(t(!0),u(i,null,n(l.result,(a=>(t(),c(y,{class:"list-item",key:a,onClick:s=>(a=>{e("callParentFn",a.keyword)})(a)},{default:r((()=>[d(h(a.keyword),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-94b557b1"]]),R=I({__name:"searchDetail",setup(a){const s=S();return(a,e)=>{const l=f;return t(),c(l,{class:"searchDetail"},{default:r((()=>[(t(!0),u(i,null,n(y(s).searchResultDetail,(a=>(t(),c(l,{class:"detail",key:a.id,onClick:s=>(a=>{console.log(a.id)})(a)},{default:r((()=>[o(l,{class:"detail-item"},{default:r((()=>[o(l,{class:"song"},{default:r((()=>[d(h(a.name),1)])),_:2},1024),o(l,{class:"album"},{default:r((()=>[d("专辑: "+h(a.album.name),1)])),_:2},1024),o(l,{class:"name"},{default:r((()=>{var s;return[d(h(a.artists[0].name)+" "+h(null==(s=a.artists[1])?void 0:s.name),1)]})),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-601dd91a"]]),j=I({__name:"searchPage",setup(s){const C=S(),I=e([]),j=e(!1),z=e(0),P=e([]),H=()=>{j.value=!j.value,j.value||(document.querySelector(".uni-input").value="",C.keyword="",z.value=0)},J=a=>{a&&!C.historyList.includes(a)?(C.historyList.push(a),localStorage.setItem("searchHistory",JSON.stringify(C.historyList)),C.keyword=a,j.value=!0,x()):(C.keyword=a,j.value=!0,x())},N=()=>{C.historyList=[],localStorage.setItem("searchHistory",JSON.stringify([]))},O=()=>{C.keyword=""},x=a=>{C.keyword&&(z.value=2,C.getResuletDetailFn())};(async()=>{const a=await L();I.value=a.data})();const V=()=>{if(C.keyword){(async()=>{const a=await D(C.keyword);l((()=>{P.value=a.result.allMatch}))})(),z.value=1}};return V(),(s,e)=>{const l=g(_("uni-icons"),a),L=f,D=v,S=b;return t(),c(L,{class:"searchPage"},{default:r((()=>[o(L,{class:"search-area"},{default:r((()=>[k(o(L,{class:"searchBar",onClick:H},{default:r((()=>[o(l,{type:"search",size:"20",color:"#b3b3b3",class:"searchIcon1"}),d(" 请输入要搜索的歌曲/歌手 ")])),_:1},512),[[m,!j.value]]),k(o(L,{class:"searchReal"},{default:r((()=>[o(L,{class:"searchReal-bar"},{default:r((()=>[o(l,{type:"search",size:"20",color:"#b3b3b3",class:"searchIcon2"}),o(D,{class:"uni-input",focus:"","confirm-type":"search",placeholder:"请输入要搜索的歌曲/歌手",modelValue:y(C).keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>y(C).keyword=a),onInput:V,onKeydown:e[1]||(e[1]=p((a=>(()=>{const a=C.keyword;J(a)})(y(C).keyword)),["enter"]))},null,8,["modelValue"]),o(l,{type:"clear",size:"20",color:"#b3b3b3",class:"clearIcon",onClick:O})])),_:1}),o(L,{class:"cancel",onClick:H},{default:r((()=>[d(" 取消 ")])),_:1})])),_:1},512),[[m,j.value]])])),_:1}),k(o(L,{class:"search-init"},{default:r((()=>[o(L,{class:"search-history"},{default:r((()=>[o(L,{class:"title"},{default:r((()=>[o(L,{class:"left"},{default:r((()=>[o(L,{class:"line"}),d(" 搜索历史 ")])),_:1}),k(o(l,{type:"trash",size:"20",onClick:N},null,512),[[m,y(C).historyList.length>0]])])),_:1}),o(L,{class:"search-history-list"},{default:r((()=>[(t(!0),u(i,null,n(y(C).historyList,((a,s)=>(t(),c(S,{class:"history-list",key:a,onClick:s=>J(a)},{default:r((()=>[d(h(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),o(L,{class:"search-hot"},{default:r((()=>[o(L,{class:"title"},{default:r((()=>[o(L,{class:"left"},{default:r((()=>[o(L,{class:"line"}),d(" 热门搜索 ")])),_:1})])),_:1}),o(L,{class:"search-hot-list"},{default:r((()=>[(t(!0),u(i,null,n(I.value,((a,s)=>(t(),c(L,{class:"hot-list",key:a,onClick:s=>J(a.searchWord)},{default:r((()=>[o(S,{class:w(s<=2?"red":"")},{default:r((()=>[d(h(s+1),1)])),_:2},1032,["class"]),o(S,{class:"list"},{default:r((()=>[d(h(a.searchWord),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1},512),[[m,0===z.value]]),k(o(F,{result:P.value,onCallParentFn:J},null,8,["result"]),[[m,1===z.value]]),k(o(R,null,null,512),[[m,2===z.value]])])),_:1})}}},[["__scopeId","data-v-c3154d6e"]]);export{j as default};
