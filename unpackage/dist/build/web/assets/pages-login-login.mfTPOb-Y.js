import{f as a,y as e,b as l,a as s,w as o,F as t,i as c,o as n,e as u,k as i,d,r as m,C as r,D as p,s as v,I as f,E as _,c as g,t as k}from"./index-Ds1uBd_9.js";import{_ as h,l as w,d as y,e as V,q as I,f as C,h as x}from"./index.CiApdTwd.js";import{u as U}from"./userInfo.BsM0yhWu.js";const j=h({__name:"login",setup(h){let j;const q=U(),A=a(0),T=a(["手机号登陆","邮箱登录","二维码登录"]),b=a(""),B=a("");async function D(){if(0===A.value){const a=await w(b.value,B.value);console.log(a),r("curCookie",a.cookie),q.getAccount(a.cookie),p({title:"登录成功,即将返回个人页面",icon:"success"}),setTimeout((()=>{v({url:"/pages/mine/mine"})}),1e3)}}async function E(){const a=await y(b.value);console.log(a)}const F=a(""),M=a("");async function z(){const a=await V(F.value,M.value);r("curCookie",a.cookie),q.getAccount(a.cookie),p({title:"登录成功,即将返回个人页面",icon:"success"}),setTimeout((()=>{v({url:"/pages/mine/mine"})}),1e3)}const G=a("");return e((()=>A.value),(()=>{2===A.value?async function(){clearInterval(j);const a=await I();console.log(a.data);const e=a.data.unikey,l=await C(e);G.value=l.data.qrimg,j=setInterval((async()=>{const a=await x(e);console.log(a),803===a.code&&(q.getAccount(),clearInterval(j),p({title:"登录成功,即将返回个人页面",icon:"success"}),setTimeout((()=>{v({url:"/pages/mine/mine"})}),1e3))}),2e3)}():clearInterval(j)}),{immediate:!0}),(a,e)=>{const r=c,p=f,v=_;return n(),l(t,null,[s(r,{class:"mine"},{default:o((()=>[u(" 我的音乐 ")])),_:1}),s(r,{class:"login"},{default:o((()=>[s(r,{class:"loginMethod"},{default:o((()=>[s(r,{class:i(["phone",{show:0===A.value}])},{default:o((()=>[s(r,{class:"inps"},{default:o((()=>[s(p,{type:"tel",class:"telInp",modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),placeholder:"请输入手机号"},null,8,["modelValue"]),s(r,null,{default:o((()=>[s(p,{type:"text",class:"capchatInp",modelValue:B.value,"onUpdate:modelValue":e[1]||(e[1]=a=>B.value=a),placeholder:"请输入验证码"},null,8,["modelValue"]),s(v,{class:"capchatBtn",onClick:E},{default:o((()=>[u(" 发送验证码 ")])),_:1})])),_:1})])),_:1}),s(v,{class:"login",onClick:D},{default:o((()=>[u("登录")])),_:1})])),_:1},8,["class"]),s(r,{class:i(["email",{show:1===A.value}])},{default:o((()=>[s(r,{class:"inps"},{default:o((()=>[s(p,{type:"email",class:"eamilInp",placeholder:"请输入邮箱",modelValue:F.value,"onUpdate:modelValue":e[2]||(e[2]=a=>F.value=a)},null,8,["modelValue"]),s(p,{type:"password",class:"passwordInp",placeholder:"请输入密码",modelValue:M.value,"onUpdate:modelValue":e[3]||(e[3]=a=>M.value=a)},null,8,["modelValue"])])),_:1}),s(v,{class:"login",onClick:z},{default:o((()=>[u("登录")])),_:1})])),_:1},8,["class"]),s(r,{class:i(["qrCode",{show:2===A.value}])},{default:o((()=>[d("img",{src:G.value,alt:""},null,8,["src"])])),_:1},8,["class"])])),_:1}),s(r,{class:"options"},{default:o((()=>[(n(!0),l(t,null,m(T.value,((a,e)=>(n(),g(r,{key:a,onClick:a=>A.value=e},{default:o((()=>[u(k(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})],64)}}},[["__scopeId","data-v-6750b8a6"]]);export{j as default};
